---
title: "Homework 2"
author: "Jackson Connor"
format: pdf
editor: visual
---

## Packages

```{r}
#| warning: false
library(tidyverse)
library(multcomp)
library(emmeans)
library(car)
```

## Problem 1

A pharmaceutical manufacturer wants to investigate the bioactivity of a new drug. A completely randomized single-factor experiment was conducted with three dosage levels, and the following results were obtained.

Complete the ANOVA Table: ANOVA Table

|            | df  | SS    | MS     | F-value | P-value |
|------------|-----|-------|--------|---------|---------|
| Bet_Dosage | 2   | 450.7 | 225.33 | 7.036   | 0.0145  |
| Error      | 9   | 288.2 | 32.03  |         |         |
| Total      | 11  | 738.9 |        |         |         |

```{r}
Observations=c(24,28,37,30,37,44,31,35,42,47,52,38)

Dosage=c(20,20,20,20,30,30,30,30,40,40,40,40)

data1<-data.frame(Observations, Dosage)

str(data1)

Dosage = factor(Dosage)

model1 <- aov(Observations ~ Dosage)

summary(model1)
```

**a.** Is there evidence to indicate that dosage level affects bioactivity?

A p-value of 0.0145 \< 0.05 supports the claim that dosage level affects bioactivity

**b.** Compute a 95 percent interval estimate of the mean of dosage level is 30g.

```{r}
data1 |>
  group_by(Dosage) |>
  summarize(mean = mean(Observations))
```

$\hat{L} = \frac{37+44+31+35}{4}$ = 36.75

$\hat{V}(\hat{L}) = \sqrt{MSE*\sum\limits_{i=1}^a\frac{C^2_i}{n_i}}$

$\sum\limits_{i=1}^a\frac{C^2_i}{n_i} = \frac{1}{4}$

```{r}
qt(0.975,9)
```

36.75 $\pm (CV * \sqrt{MSE*\sum\limits_{i=1}^a\frac{C^2_i}{n_i}}) = 36.75 \pm (2.262 * \sqrt{32*\frac{1}{4}})$ = 36.75 $\pm$ 6.3979

(30.352, 43.148)

**c.** Compute a 99 percent interval estimate of the mean difference between dosages levels 20g and 40g.

$\hat{L} = \frac{24+28+37+30}{4}-\frac{42+47+52+38}{4} = 29.75-44.75 = -15$

$\sum\limits_{i=1}^a\frac{C^2_i}{n_i} = \frac{1}{4}+\frac{1}{4} = \frac{2}{4}$

```{r}
qt(0.995,9)
```

$-15 \pm (3.2498*\sqrt{32*\frac{2}{4}}) = -15 \pm 12.9992$

(-27.9992, -2.0008)

**d.** Compute simultaneous 95% CIs for the difference in means for dosage levels 20g and 40g, based on Tukey’s, Bonferroni’s and Scheffe’s Methods:

**Bonferroni**

$t_{(1-\frac{\alpha}{2*g}), df_{error}}$ = Bonferroni's CV

g = $\frac{a(a-1)}{2} = \frac{3(2)}{2}$ = 3

```{r}
qt(1-(0.05/(2*3)), 9)
```

$\hat{L}\pm B*\sqrt{\hat{V}(\hat{L})}$ = -15 $\pm (2.933*\sqrt{16}) = -15 \pm 11.732$

(-26.732, -3.268)

**Tukey's**

```{r}
qtukey(0.95, 3, 9)
```

Q = 3.948/$\sqrt{2}$ = 2.792

$HSD = Q*\sqrt{MSE(\frac{1}{n_i}+\frac{1}{n_j})} = 2.792 * \sqrt{16} = 11.167$

$\hat{L}\pm HSD = -15 \pm 11.167$

(-26.167, -3.833)

**Scheffe**

$\sqrt{(a-1)f_{(1-\alpha),(a-1),df_{error}}}$ = Scheffe's CV

```{r}
qf(0.95, 2, 9)
```

$\sqrt{2*4.256}$ = 2.918

$\hat{L} \pm S * \sqrt{\hat{V}(\hat{L})} = -15 \pm (2.918 * \sqrt{16}) = -15 \pm 11.672$

(-26.672, -3.328)

**e.** Use Tukey’s HSD to compare pairs of treatment means.

|                           | Difference | Significant (\>HSD of 11.167) |
|---------------------------|------------|-------------------------------|
| 20g-30g = \|29.75-36.75\| | 7          | N                             |
| 20g-40g = \|29.75-44.75\| | 15         | Y                             |
| 30g-40g = \|36.75-44.75\| | 8          | N                             |

## Problem 2

The tensile strength of Portland cement is being studied. Four different mixing techniques can be used economically. A completely randomized experiment was conducted, and the following data were collected.

You are given the following information:

Y ̅*(1.)=2971.00,s(Y ̅*(1.) )=56.65 and MSE=12825.7

Y ̅*(2.)=3156.25,s(Y ̅*(2.) )=56.65

Y ̅*(3.)=2933.75,s(Y ̅*(3.) )=56.65

Y ̅*(4.)=2666.25,s(Y ̅*(4.) )=56.65

**a.** Test the hypothesis that mixing techniques affect the strength of the cement.

```{r}
Tensile_Strength=c(3129,3000,2865,2890,3200,3300,2975,3150,2800,2900,2985,3050,
                   2600,2700,2600,2765)

Mixing_Technique=c(1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4)

data<-data.frame(Tensile_Strength,Mixing_Technique)

str(data)

Mixing_Technique = factor(Mixing_Technique)

model <- aov(Tensile_Strength ~ Mixing_Technique)

summary(model)
```

**b.** Find a 95 percent confidence interval on the mean tensile strength of the Portland cement produced by mixing technique 3.

$\bar{y_3}$ = 2933.7, s($\bar{y_3}$) = 56.65

$\hat{V}(\hat{L}) = \sqrt{MSE*\sum\limits_{i=1}^a\frac{C^2_i}{n_i}} = \sqrt{12825.7*\frac{1}{4}}$ = 56.625

```{r}
qt(0.975, 12)
```

$2933.7 \pm (2.179*56.625)$ = **(2810.31, 3057.09)**

**c.** Find a 95 percent confidence interval on the difference in means for techniques 1 and 3 & 3 and 4.

$L = \frac{\mu_1 + \mu_3}{2}-\frac{\mu_3+\mu_4}{2} = (\frac{1}{2})\mu_1 + (0)\mu_2 + (\frac{1}{2})\mu_3 + (\frac{-1}{2})\mu_3 + (\frac{-1}{2})\mu_4$

$\hat{L} = \frac{\hat{y_1}+\hat{y_3}}{2}-\frac{\hat{y_3}+\hat{y_4}}{2} = \frac{{2971}+{2933.75}}{2}-\frac{{2933.75}+{2666.25}}{2}$ = 152.375

$\sum\limits^4_{i=1}\frac{c^2_i}{n_i} = {\frac{\frac{1}{2}^2}{4}} + {\frac{\frac{1}{2}^2}{4}} + {\frac{\frac{-1}{2}^2}{4}} + {\frac{\frac{-1}{2}^2}{4}}$ = 0.25

$\hat{V}(\hat{L}) = mse * \sum\limits^4_{i=1}\frac{c^2_i}{n_i}$ = 12825.7 * 0.25 = 3206.425

```{r}
qt(0.975,12)
```
152.375 $\pm (2.179 * \sqrt{3206.425})$ = 152.375 $\pm$ 123.387

(28.988, 275.76)

**d.** Compute simultaneous 95% CIs for the difference in means for techniques 1 and 3, based on Tukey’s, Bonferroni’s and Scheffe’s Methods:

$\hat{L} = \hat{y_1}-\hat{y_3}$ = 2971.00 - 2933.75 = 37.25

$\hat{V}(\hat{L}) = mse * \sum\limits^4_{i=1}\frac{c^2_i}{n_i} = 12825.7 * (\frac{1}{4}+\frac{1}{4})$ = 6412.85

**Tukey's**

```{r}
qtukey(0.95, 3, 12)
```
Q = 3.773/$\sqrt{2}$  2.668

$HSD = Q*\sqrt{MSE(\frac{1}{n_i}+\frac{1}{n_j})}$ = 2.668 * $\sqrt{6412.85}$ = 213.647

37.25 $\pm$ 213.647

(-176.397, 250.897)

**Bonferroni's**

$t_{(1-\frac{\alpha}{2*g}), df_{error}}$ = Bonferroni's CV

g = $\frac{a(a-1)}{2} = \frac{4(3)}{2}$ = 6

1-(0.05/12)

```{r}
qt(.9958,12)
```

$\hat{L} \pm B * \sqrt{\hat{V}(\hat{L})} = 37.25 \pm (3.148 * \sqrt{6412.85}) = 37.25 \pm 252.124$

(-214.874, 289.374)

**Scheffe's**

$\sqrt{(a-1)f_{(1-\alpha),(a-1),df_{error}}}$ = Scheffe's CV

```{r}
qf(0.95, 3, 12)
```
$\sqrt{3*3.49}$ = 3.236

$\hat{L} \pm S * \sqrt{\hat{V}(\hat{L})} = 37.25 \pm (3.236*\sqrt{6412.85}) = 37.25 \pm 259.130$

(-221.880, 296.380)

**e.** Compute Bonferroni’s Minimum Significant Difference

$t_{(1-\frac{\alpha}{2*g}), df_{error}}$ = Bonferroni's CV

g = $\frac{a(a-1)}{2} = \frac{4(3)}{2}$ = 6 $1-\frac{0.05}{2*6}$ = 1 - .0042 = .9958

```{r}
qt(.9958, 12)
```

$B_{CV} * \sqrt{\hat{V}(\hat{L})}$ = 3.14839 \* 80.08 = 252.124

**f.** Compute Tukey’s Honest Significant Difference

$qtukey_{1-\alpha, df_{btwn}, df_{error}}$ = Tukey's CV

```{r}
qtukey(0.95, 3, 12)
```

$3.772929 \div \sqrt{2}$ = 2.668

$Tukey_{CV} * \sqrt{\hat{V}(\hat{L})}$ = 2.668 \* 80.08 = 213.647

**g.** Compute Scheffe’s Minimum Significant Difference

$\sqrt{(a-1)f_{(1-\alpha),(a-1),df_{error}}}$ = Scheffe's CV

```{r}
qf(0.95,3,12)
```

S = $\sqrt{3*3.490295}$ = 3.236

$S_{CV} * \sqrt{\hat{V}(\hat{L})}$ 3.236 \* 80.08 = 259.130

## Problem 3

A study is conducted to compare 4 menus in terms of numbers of calories ordered by restaurant customers (in 100s of calories). The treatments (menus) are (consider them increasing in order of information provided):   
1) No Calories Reported     2) Calories Reported      3) Rank-Ordered Calories   4) Color-Coded Calories
 The sample sizes are all based on samples of r = 20 customers per menu. The sample means and estimated variance are:
 ¯Y_(1•)=17.6 ¯Y_(2•)=16.8 ¯Y_(3•)=16.0 ¯Y_(4•)=14.4 ¯Y_(••)=16.2
 s^2="MSE "=196.0.
Give 3 orthogonal contrasts, and their estimates and estimated standard errors
Contrast 1: Menu 1 vs Menus {2, 3, 4}
Contrast 2: Menu 2 vs Menus {3, 4} 
Contrast 3: Menu 3 vs Menu 4

$L_1 = (3)\mu_1 - \mu_2 - \mu_3 - \mu_4$

$\hat{L}_1 = (3)17.6 -(16.8 + 16 + 14.4)$ = 5.6

$sd(\hat{L}_1) = \sqrt{196 * (\frac{3^2}{20}+\frac{1^2}{20}+\frac{1^2}{20}+\frac{1^2}{20})}$ = 10.844

$L_2 = (0)\mu_1 + (2)\mu_2 + \mu_3 + \mu_4$
$\hat{L}_2 = (0)17.6 + (2)16.8 - (16 + 14.4)$ = 3.2
$sd(\hat{L}_2) = \sqrt{196 * (\frac{2^2}{20} +\frac{1^2}{20} +\frac{1^2}{20})}$ = 7.668

$L_3 = \mu_3 - \mu_4$
$\hat{L}_3 = 16 - 14.4$ = 1.6
$sd(\hat{L}_3) = \sqrt{196 * (\frac{1^2}{20} +\frac{1^2}{20})}$ = 4.427

## Problem 4
An article in Environment International (Vol. 18, No. 4, 1992) describes an experiment in which the amount of radon released in showers was investigated. Radon enriched water was used in the experiment and six different Orifice diameters were tested in shower heads. The data from the experiment are shown in the following table.
 
```{r}
radon_release<-c(80,83,83,85,75,75,79,79,74,73,76,
                 77,67,72,74,74,62,62,67,69,60,61,64,66)
diameter<-c(rep("0.37",4),rep("0.51",4),rep("0.71",4),
            rep("1.02",4),rep("1.40",4),rep("1.99",4))
radon_data<-data.frame(radon_release,diameter)
radon_data
str(radon_data)

```


**a.**	Write a suitable model (Factor effects) for this experiment. Define all terms in the model. Include all assumptions of the model.

$Y_{ij} = \mu + \alpha_i + \epsilon_{ij}$

Where $\mu$ is population mean

$\alpha_i$ is the treatment effect of the ith group

$\mu + \alpha_i = \mu_i$ is the mean of the ith group

$i$ is the number of treatments, 1-6

$j$ is the number of observations within each treatment, 1-4

$\epsilon_{ij}$ is the random error

Assumptions:

- All observations are independent from one another

- The population is approximately normally distributed

- Constant variance

**b.**	Obtain point estimates and standard deviation of the radon released at each level.

```{r}
radon_data |>
  group_by(diameter) |>
  summarize(point_estimate = mean(radon_release), sd = sd(radon_release))
```


**c.**	Does the size of the orifice affect the mean percentage of radon released? Use α = 0.05

$H_0: \mu_1 = \mu_2 = \mu_3 = \mu_4 = \mu_5 = \mu_6$

$H_a$: at least one $\mu$ is different from the rest

```{r}
ano_mod <- aov(radon_release ~ diameter, data = radon_data)
summary(ano_mod)
```
With a p-value of 3.16e-08 which is less than the alpha of 0.05, we reject the null hypothesis and have strong evidence to support the alternative, that the size of the orifice does affect the mean percentage of radon release.

**d.**	Construct a normal probability plot of the residuals. What conclusion would you draw about the validity of the normality assumption?

```{r}
norm <- lm(radon_release ~ diameter, data = radon_data)

plot(norm, which = c(2), sub.caption = "Problem 4D Jackson Connor")
```
Based on the QQplot above, we can see that the observations mostly follow the line with no dramatic outliers, indicating linearity and that normality has been met.

**e.**	Plot the residuals versus the predicted radon release. Comment on the plot.

```{r}
plot(norm, which = c(1), sub.caption = "Problem 4E Jackson Connor")
```
The observations are randomly distributed around the red line with no obvious pattern, indicating that constant variance assumption has been met.

**f.**	Test by means of the Modified Leven’s (Brown-Forsythe) and Bartlett’s test whether the treatment error variances for the response variable are equal.

```{r}
#Bartlett

bartlett.test(radon_release ~ diameter, data = radon_data)
```
```{r}
#Modified Levene's

leveneTest(radon_release ~ diameter, data = radon_data, center = median)

```
As both the Bartlett and Modified Levene's tests had p-values greater than 0.05 (0.8733 and 0.5261 respectively) we can assume equal variance.

**g.**	Test the normality assumption using Shapiro-Wilk test.

```{r}
resid <- residuals(ano_mod)

shapiro.test(resid)
```
As our p-value is greater than 0.05 (0.1247>0.05), we can assume that the residuals follow an approximately normal distribution.

**h.**	Use the Tukey’s and Bonferroni’s methods to make comparisons among the five treatments to determine specifically which treatments differ in radon release.

```{r}
TukeyHSD(ano_mod)
```
According to Tukey'sHSD, the differences are signficantly different between 0.71-0.37, 1.02-0.37, 1.40-0.37, 1.99-0.37, 1.40-0.51, 1.99-0.51, 1.40-0.71, 1.99-0.71, 1.40-1.02, and 1.99-1.02 at the significance level of 0.05.

```{r}
pairwise.t.test(radon_release, diameter, p.adjust.method = "bonf")
```
According to the Bonferroni method, there is significant difference between the means of 0.71-0.37, 1.02-0.37, 1.40-0.37, 1.99-0.37, 1.40-0.51, 1.99-0.51, 1.40-0.71, 1.99-0.71, 1.40-1.02, and 1.99-1.02 at the significance level of 0.05.
